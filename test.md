# Тестовое задание на позицию Data Scientist в области NLP

# Данные:

У вас есть список переписок в виде YAML файла. Каждая переписка представляет собой словарь с полями:

- `history` — список сообщений, где каждое сообщение является словарем с двумя ключами:
  - `role`: роль автора сообщения (например, пользователь или ассистент)
  - `content`: текст сообщения
- `inquire_product`: метка, которую необходимо предсказать (True или False). Метка True проставлена в переписках, где на момент последнего сообщения пользователь хочет сравнить несколько товаров или запросить информацию о конкретном товаре.
- `messages_uuid`: уникальный идентификатор переписки.

**Пример структуры YAML:**

```yaml
- history:
    - content: привет, добавь мне сок яблочный 1 л
      role: user
  inquire_product: false
  messages_uuid: a2a5bb5b-8059-5403-95fa-02fee21b33ea
```

# Задание:

1. **Предложить метод классификации переписок** на предмет того, хочет ли пользователь сравнить несколько товаров или получить информацию о конкретном товаре (то есть предсказать метку `inquire_product`). Ожидается, что вы предложите подход (или подходы), которые можно использовать для данной задачи, опираясь на особенности данных. Ваш метод может включать машинное обучение, правила или их комбинацию.

2. **Реализовать предложенный метод в коде**:
   - Напишите код, который принимает на вход набор переписок, выполняет предложенные преобразования и обучает модель (если ваше решение требует обучения модели).
   - Важно, чтобы ваш код был минималистичным, выполняя только необходимые шаги для запуска обучения. Обратите внимание на то, что код должен позволять проверить качество модели на отложенной выборке.

3. **Обернуть модель в сервис**:
   - Напишите сервис на базе REST API (например, используя FastAPI), который принимает переписку и возвращает предсказание для данной переписки (True/False — является ли переписка примером inquire_product).
   - Сервис должен включать один эндпоинт: POST-запрос, который принимает переписку в формате JSON и возвращает результат предсказания.

4. **Инструкция по деплою**:
   - Напишите инструкцию по деплою разработанного сервиса.
   - Предпочтительно использовать Docker и Docker Compose для контейнеризации и деплоя сервиса.

# Оценочные критерии:

- Четкость и обоснованность предложенного метода классификации (нужно для целей голосового чат-бота).
- Чистота и эффективность кода.
- Работоспособность сервиса.
- Документация.
- Наличие инструкции по деплою сервиса.

# Технические требования:

- Использование Python 3.9+.
- Для сервиса — лучше использование FastAPI, но допустим любой фреймворк.
- По стеку для обучения модели — любые библиотеки, если будут какие-то сети, то предпочтительно использовать PyTorch.
- Обязательна возможность локального запуска сервиса.

# Ожидаемые результаты:

- Решение задачи классификации с кодом, который можно легко протестировать на отложенной выборке.
- API-сервис для предсказания inquire_product с примером запроса и результата.
- Инструкция по деплою, предпочтительно с использованием Docker Compose.

